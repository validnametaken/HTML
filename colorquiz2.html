<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Animal Color Game</title>
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #fafafa;
      }

      canvas {
        border: 2px solid #333;
        margin: 20px;
        background: white;
      }

      button {
        margin: 5px;
        padding: 10px 20px;
        font-size: 16px;
      }

      #result {
        font-size: 18px;
        margin-top: 15px;
        font-weight: bold;
      }
    </style>
  </head>

  <body>
    <h1>üêæ Guess the Missing Color!</h1>
    <canvas id="gameCanvas" width="400" height="300"></canvas>
    <div id="choices"></div>
    <p id="result"></p>
    <button id="nextBtn" onclick="startGame()">Next Round</button>
    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d"); // Animal set (replace with your own images)
      const animals = [
        { img: "colorquiz/pig.jpg", missing: "pink" },
        { img: "colorquiz/frog.jpg", missing: "green" },
        { img: "colorquiz/ladybug.jpg", missing: "red" },
        { img: "colorquiz/clownfish.jpg", missing: "orange" },
        { img: "colorquiz/duckling.jpg", missing: "yellow" },
        { img: "colorquiz/peacock.jpg", missing: "blue" },
        { img: "colorquiz/bear.jpg", missing: "brown" },
      ];
      // Hue ranges for different colors const
      colorRanges = {
        pink: {
          hueMin: 220,
          hueMax: 40,
          satMin: 0.1,
          lightMin: 0.1,
          lightMax: 0.99,
        },
        red: {
          hueMin: 100,
          hueMax: 20,
          satMin: 0.3,
          lightMin: 0.1,
          lightMax: 1.0,
        },
        orange: {
          hueMin: 1,
          hueMax: 60,
          satMin: 0.6,
          lightMin: 0.1,
          lightMax: 0.99,
        },
        yellow: {
          hueMin: 10,
          hueMax: 60,
          satMin: 0.3,
          lightMin: 0.2,
          lightMax: 0.99,
        },
        green: {
          hueMin: 30,
          hueMax: 100,
          satMin: 0.1,
          lightMin: 0.1,
          lightMax: 0.8,
        },
        blue: {
          hueMin: 180,
          hueMax: 250,
          satMin: 0.2,
          lightMin: 0.15,
          lightMax: 0.9,
        },
        purple: {
          hueMin: 250,
          hueMax: 310,
          satMin: 0.2,
          lightMin: 0.15,
          lightMax: 0.9,
        },
        brown: {
          hueMin: 1,
          hueMax: 40,
          satMin: 0.0,
          lightMin: 0.1,
          lightMax: 0.8,
        },
      };

      let targetColor = "";
      let currentImage = null;
      let remainingAnimals = [...animals];
      let currentAnimal = null;
      function startGame() {
        document.getElementById("result").textContent = "";
        document.getElementById("choices").innerHTML = "";
        if (remainingAnimals.length === 0) {
          document.getElementById("result").textContent = "üéâ Congratulations! You've guessed all the colors!";
          document.getElementById("result").style.color = "green";
          document.getElementById("nextBtn").textContent = "Play Again";
          document.getElementById("nextBtn").onclick = resetGame;
          return;
        }
        document.getElementById("nextBtn").textContent = "Next Round";
        document.getElementById("nextBtn").onclick = startGame;
        const index = Math.floor(Math.random() * remainingAnimals.length);
        currentAnimal = remainingAnimals[index];
        targetColor = currentAnimal.missing;
        const img = new Image();
        img.src = currentAnimal.img;
        img.onload = () => {
          currentImage = img;
          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
          removeColor(targetColor);
          showChoices();
        };
      }

      function removeColor(colorName) {
        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const data = imageData.data;
        const { hueMin, hueMax, satMin, lightMin, lightMax } =
          colorRanges[colorName];
        for (let i = 0; i < data.length; i += 4) {
          let r = data[i];
          let g = data[i + 1];
          let b = data[i + 2];
          let [h, s, l] = rgbToHsl(r, g, b);
          let inHueRange = false;
          if (hueMin <= hueMax) {
            inHueRange = h >= hueMin && h <= hueMax;
          } else {
            inHueRange = (h >= hueMin && h <= 360) || (h >= 0 && h <= hueMax);
          }
          if (inHueRange && s >= satMin && l >= lightMin && l <= lightMax) {
            let avg = (r + g + b) / 3;
            data[i] = avg;
            data[i + 1] = avg;
            data[i + 2] = avg;
          }
        }
        ctx.putImageData(imageData, 0, 0);
      }
      function rgbToHsl(r, g, b) {
        r /= 255;
        g /= 255;
        b /= 255;

        const max = Math.max(r, g, b),
          min = Math.min(r, g, b);
        let h,
          s,
          l = (max + min) / 2;
        if (max === min) {
          h = s = 0;
        } else {
          const d = max - min;
          s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
          switch (max) {
            case r:
              h = ((g - b) / d + (g < b ? 6 : 0)) * 60;
              break;
            case g:
              h = ((b - r) / d + 2) * 60;
              break;
            case b:
              h = ((r - g) / d + 4) * 60;
              break;
          }
        }
        return [h, s, l];
      }
      function showChoices() {
        const choiceDiv = document.getElementById("choices");
        const options = [
          "pink",
          "red",
          "green",
          "blue",
          "yellow",
          "orange",
          "purple",
          "brown",
        ];
        let shuffled = [...options].sort(() => Math.random() - 0.5);
        shuffled.forEach((c) => {
          const btn = document.createElement("button");
          btn.textContent = c;
          btn.onclick = () => checkAnswer(c);
          choiceDiv.appendChild(btn);
        });
      }
      function checkAnswer(choice) {
        const result = document.getElementById("result");
        if (choice === targetColor) {
          result.textContent =
            "‚úÖ Correct! The missing color was " + targetColor;
          result.style.color = "green";
          remainingAnimals = remainingAnimals.filter(a => a !== currentAnimal);
          if (currentImage) {
            ctx.drawImage(currentImage, 0, 0, canvas.width, canvas.height);
          }
        } else {
          result.textContent = "‚ùå Wrong! The missing color was " + targetColor;
          result.style.color = "red";
        }
      }

      function resetGame() {
        remainingAnimals = [...animals];
        document.getElementById("nextBtn").textContent = "Next Round";
        document.getElementById("nextBtn").onclick = startGame;
        startGame();
      }

      // Start automatically startGame();
    </script>
  </body>
</html>
